webpackJsonp([11,27],{DfzG:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i("gN++"),l=i("Ks07"),o=i("6pD/"),a=i("vMJZ"),s={components:{eForm:i("FRr9").default},mixins:[l.a],data:function(){return{unitName:"",defaultCheckedKeys:[],units:[],unitId:"",permission:!1,peoples:[],delLoading:!1,defaultProps:{children:"children",label:"name"},query:{name:"",enabled:""},dicts:[{key:"0",display_name:"激活"},{key:"1",display_name:"锁定"}],downloadLoading:!1,loading:!1,data:[]}},created:function(){var e=this;this.$nextTick(function(){e.init(),e.getUnitDatas()})},methods:{beforeInit:function(){this.url="api/user/account";var e=this.query,t=e.name,i=e.enabled;return this.params={page:this.page,size:this.size,unitId:this.unitId,name:t,enabled:i},!0},getUnitDatas:function(){var e=this,t={id:"ID",sort:"desc",name:this.unitName};Object(n.h)(t).then(function(t){e.units=t.result,e.unitId=t.result[0].id,e.getPeoples(),"system"===t.ext.userAccount&&(e.permission=!0)})},handleNodeClick:function(e){0===e.id?this.unitId=null:(this.unitId=e.id,this.getPeoples()),this.init(),this.defaultCheckedKeys=[e.id]},toQuery:function(){this.page=0,this.init()},add:function(){if(void 0===this.unitId||""===this.unitId)this.$notify({title:"请选择部门",type:"error",duration:2500});else{this.isAdd=!0;var e=this.$refs.form;e.form={unitId:this.unitId,peoples:this.peoples,enabled:"0"},e.dialog=!0,e.isManager=this.permission}},edit:function(e){if("system"===e.userAccount)this.$notify({title:"此账号不可修改！",type:"error",duration:2500});else{this.isAdd=!1;var t=this.$refs.form;t.form={id:e.id,unitId:this.unitId,userAccount:e.userAccount,peopleId:e.peopleId,enabled:e.enabled},t.dialog=!0,t.isManager=this.permission}},subDelete:function(e){var t=this;this.delLoading=!0;var i={id:e};Object(a.b)(i).then(function(i){t.delLoading=!1,t.$refs[e].doClose(),t.init(),t.$notify({title:"删除成功",type:"success",duration:2500})}).catch(function(i){t.delLoading=!1,t.$refs[e].doClose(),console.log(i.response.data.message)})},downloadPeople:function(){var e=this;this.$confirm("是否包含下级单位?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(function(){var t={unitId:e.unitId,isChild:"1"};e.outExcel(t)}).catch(function(){var t={unitId:e.unitId,isChild:"0"};e.outExcel(t)})},getPeoples:function(){var e=this;Object(o.f)({unitId:this.unitId}).then(function(t){e.peoples=t.result})}}},r={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("el-row",{staticStyle:{"margin-left":"5px"},attrs:{gutter:20}},[i("el-col",{attrs:{xs:7,sm:6,md:4,lg:4,xl:4}},[i("div",{staticClass:"head-container",staticStyle:{"padding-top":"10px"}},[i("el-input",{staticClass:"filter-item",staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"输入单位名称搜索","prefix-icon":"el-icon-search"},on:{input:e.getUnitDatas},model:{value:e.unitName,callback:function(t){e.unitName=t},expression:"unitName"}})],1),e._v(" "),i("el-tree",{ref:"tree",attrs:{data:e.units,"node-key":"id",props:e.defaultProps,"highlight-current":!0,"expand-on-click-node":!1,"default-checked-keys":e.defaultCheckedKeys,"default-expand-all":""},on:{"node-click":e.handleNodeClick}})],1),e._v(" "),i("el-col",{attrs:{xs:17,sm:18,md:20,lg:20,xl:20}},[i("div",{staticClass:"head-container",staticStyle:{"padding-top":"10px"}},[i("el-input",{staticClass:"filter-item",staticStyle:{width:"10%"},attrs:{clearable:"",placeholder:"姓名或简名"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.toQuery(t)}},model:{value:e.query.name,callback:function(t){e.$set(e.query,"name",t)},expression:"query.name"}}),e._v(" "),i("el-select",{staticClass:"filter-item",staticStyle:{width:"10%"},attrs:{clearable:"",placeholder:"状态"},on:{change:e.toQuery},model:{value:e.query.enabled,callback:function(t){e.$set(e.query,"enabled",t)},expression:"query.enabled"}},e._l(e.dicts,function(e){return i("el-option",{key:e.key,attrs:{label:e.display_name,value:e.key}})}),1),e._v(" "),i("el-button",{staticClass:"filter-item",attrs:{size:"mini",type:"success",icon:"el-icon-search"},on:{click:e.toQuery}},[e._v("搜索")]),e._v(" "),i("div",{staticStyle:{display:"inline-block",margin:"0px 2px"}},[i("el-button",{staticClass:"filter-item",attrs:{size:"mini",type:"primary",icon:"el-icon-plus"},on:{click:e.add}},[e._v("新增")])],1),e._v(" "),i("div",{staticStyle:{display:"inline-block"}},[i("el-button",{staticClass:"filter-item",attrs:{loading:e.downloadLoading,size:"mini",type:"warning",icon:"el-icon-download"},on:{click:e.downloadPeople}},[e._v("导出")])],1),e._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%","font-size":"10px"},attrs:{"row-style":{height:"15px"},"cell-style":{padding:"0px"},data:e.data,size:"small","row-key":"id","element-loading-text":"请稍后","highlight-current-row":"","element-loading-spinner":"el-icon-loading",border:""}},[i("el-table-column",{attrs:{type:"index",width:"50"}}),e._v(" "),i("el-table-column",{attrs:{sortable:"","show-overflow-tooltip":!0,label:"账号",prop:"userAccount"}}),e._v(" "),i("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"peopleName",label:"人员姓名"}}),e._v(" "),i("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"permission",label:"账号权限"}}),e._v(" "),i("el-table-column",{attrs:{"show-overflow-tooltip":!0,label:"状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(e.dicts,function(n){return i("div",{key:n.key},[t.row.enabled.toString()===n.key?i("el-tag",{attrs:{type:t.row.enabled?"":"info"}},[e._v(e._s(n.display_name))]):e._e()],1)})}}])}),e._v(" "),i("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"tag",fixed:"right",label:"操作",width:"130px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-edit"},on:{click:function(i){return e.edit(t.row)}}}),e._v(" "),i("el-popover",{ref:t.row.id,attrs:{placement:"top",width:"180"}},[i("p",[e._v("确定删除本条数据吗？")]),e._v(" "),i("div",{staticStyle:{"text-align":"right",margin:"0"}},[i("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(i){e.$refs[t.row.id].doClose()}}},[e._v("取消")]),e._v(" "),i("el-button",{attrs:{loading:e.delLoading,type:"primary",size:"mini"},on:{click:function(i){return e.subDelete(t.row.id)}}},[e._v("确定")])],1),e._v(" "),i("el-button",{attrs:{slot:"reference",disabled:1===t.row.id,type:"danger",icon:"el-icon-delete",size:"mini"},slot:"reference"})],1)]}}])})],1),e._v(" "),i("el-pagination",{staticStyle:{"margin-top":"2px",float:"right"},attrs:{total:e.total,"current-page":e.page+1,layout:"total, prev, pager, next, jumper, sizes"},on:{"size-change":e.sizeChange,"current-change":e.pageChange}})],1)]),e._v(" "),i("eForm",{ref:"form",attrs:{"is-add":e.isAdd,peoples:e.peoples}})],1)],1)},staticRenderFns:[]};var d=i("VU/8")(s,r,!1,function(e){i("nflY")},"data-v-2696224e",null);t.default=d.exports},FRr9:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i("vMJZ"),l=i("GXH0"),o=i.n(l),a=(i("DmJO"),{components:{Treeselect:o.a},props:{isAdd:{type:Boolean,required:!0},peoples:{type:Array,required:!0}},data:function(){var e=this;return{dialog:!1,loading:!1,isManager:!1,people:"",form:{userAccount:"",newPass:"",userPassword:"",enabled:"1",peopleId:[],unitId:"",permission:""},peopleId:"",dicts:[{value:"0",label:"激活"},{value:"1",label:"锁定"}],permissions:[{value:"0",label:"普通用户"},{value:"1",label:"管理员"}],level:3,rules:{userAccount:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:2,max:20,message:"长度在 2 到 20 个字符",trigger:"blur"}],userPassword:[{required:!0,validator:function(t,i,n){i?e.form.newPass!==i?n(new Error("两次输入的密码不一致")):n():n(new Error("请再次输入密码"))},trigger:"blur"}]}}},created:function(){navigator.userAgent.indexOf("Chrome")>=0?this.style="width: 184px":this.style="width: 172px"},methods:{cancel:function(){this.resetForm()},doSubmit:function(){var e=this;this.$refs.form.validate(function(t){t&&(e.loading=!0,e.isAdd?e.doAdd():e.doEdit())})},doAdd:function(){var e=this;Object(n.a)(this.form).then(function(t){e.resetForm(),e.$notify({title:"添加成功",type:"success",duration:2500}),e.loading=!1,e.$parent.$parent.init()}).catch(function(t){e.loading=!1,console.log(t.response.data.message)})},doEdit:function(){var e=this;Object(n.c)(this.form).then(function(t){e.resetForm(),e.$notify({title:"修改成功",type:"success",duration:2500}),e.loading=!1,e.$parent.$parent.init()}).catch(function(t){e.loading=!1,console.log(t.response.data.message)})},resetForm:function(){this.dialog=!1,this.$refs.form.resetFields(),this.form={username:"",enabled:"false"}}}}),s={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("el-dialog",{attrs:{visible:e.dialog,title:e.isAdd?"新增用户":"编辑用户","append-to-body":"",width:"570px"},on:{"update:visible":function(t){e.dialog=t}}},[i("el-form",{ref:"form",attrs:{inline:!0,model:e.form,rules:e.rules,size:"small","label-width":"88px"}},[i("el-form-item",{attrs:{label:"用户名",prop:"userAccount"}},[i("el-input",{model:{value:e.form.userAccount,callback:function(t){e.$set(e.form,"userAccount",t)},expression:"form.userAccount"}})],1),e._v(" "),i("div",{attrs:{hidden:"true"}},[i("el-form-item",{attrs:{label:"单位Id",prop:"unitId",hidden:"true"}},[i("el-input",{model:{value:e.form.unitId,callback:function(t){e.$set(e.form,"unitId",t)},expression:"form.unitId"}})],1)],1),e._v(" "),i("el-form-item",{attrs:{label:"新密码",prop:"newPass"}},[i("el-input",{attrs:{type:"password"},model:{value:e.form.newPass,callback:function(t){e.$set(e.form,"newPass",t)},expression:"form.newPass"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"确认密码",prop:"userPassword"}},[i("el-input",{attrs:{type:"password"},model:{value:e.form.userPassword,callback:function(t){e.$set(e.form,"userPassword",t)},expression:"form.userPassword"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"受理人",prop:"nationality"}},[i("el-select",{attrs:{filterable:"",placeholder:"选择人员"},model:{value:e.form.peopleId,callback:function(t){e.$set(e.form,"peopleId",t)},expression:"form.peopleId"}},e._l(e.peoples,function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),e.isManager?i("el-form-item",{attrs:{label:"权限",prop:"nationality"}},[i("el-select",{attrs:{filterable:"",placeholder:"请选择"},model:{value:e.form.roles,callback:function(t){e.$set(e.form,"roles",t)},expression:"form.roles"}},e._l(e.permissions,function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1):e._e(),e._v(" "),i("el-form-item",{attrs:{label:"状态",prop:"enabled"}},e._l(e.dicts,function(t){return i("el-radio",{key:t.value,attrs:{label:t.value},model:{value:e.form.enabled,callback:function(t){e.$set(e.form,"enabled",t)},expression:"form.enabled"}},[e._v(e._s(t.label))])}),1)],1),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"text"},on:{click:e.cancel}},[e._v("取消")]),e._v(" "),i("el-button",{attrs:{loading:e.loading,type:"primary"},on:{click:e.doSubmit}},[e._v("确认")])],1)],1)],1)},staticRenderFns:[]};var r=i("VU/8")(a,s,!1,function(e){i("HIVu")},"data-v-c1353240",null);t.default=r.exports},HIVu:function(e,t){},nflY:function(e,t){}});