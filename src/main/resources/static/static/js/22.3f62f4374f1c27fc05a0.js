webpackJsonp([22],{U8s4:function(t,e){},pF3t:function(t,e,l){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=l("gN++"),i={data:function(){return{defaultProps:{children:"children",label:"label"},allInfodialog:!1,category:{},repeat:!1,radio:!1,unitId:"",excelLoading:!1,unitIds:[],unitSelect:[],units:[],centerDialogVisible:!1,titles:"",flag:"",form:{dataFlag:"",unitId:"",unitIds:"",unitName:""},rules:{unitName:[{required:!0,message:"请选择单位！",trigger:"blur"}]}}},created:function(){this.getUnitTrees()},methods:{getUnitTrees:function(){var t=this;Object(o.l)({enabled:"0"}).then(function(e){t.units=e.result,t.unitId=e.result[0].id}),Object(o.m)().then(function(e){t.unitSelect=e.result,t.unitName=e.result[0].name})},exportExcleMode:function(t){var e={flag:t};this.$axios({method:"post",url:"http://localhost:8085/api/unit/outExcelModel",params:e,contentType:"application/x-www-form-urlencoded",responseType:"blob"}).then(function(e){console.log(e);var l=document.createElement("a"),o=new Blob([e.data],{type:"application/vnd.ms-excel"});l.style.display="none",l.href=URL.createObjectURL(o),"all"===t?l.setAttribute("download","全部信息采集表.xls"):"unit"===t?l.setAttribute("download","单位信息采集表.xls"):"people"===t&&l.setAttribute("download","人员信息采集表.xlsx"),document.body.appendChild(l),l.click(),document.body.removeChild(l)}).catch(function(t){console.log(t)})},exportDataDialog:function(t){this.form={dataFlag:t,unitName:this.unitName},"filingList"===t?(this.radio=!0,this.titles="职级备案",this.centerDialogVisible=!0,this.flag=t):"reimbursement"===t&&(this.radio=!0,this.titles="任免审批表",this.centerDialogVisible=!0,this.flag=t)},exportData:function(){void 0!=this.$refs.tree?this.unitIds=this.$refs.tree.getCheckedNodes():this.unitIds=[];var t={flag:this.form.dataFlag,units:this.unitIds,unitName:this.form.unitName},e=this.form.dataFlag;this.centerDialogVisible=!1,this.$axios({method:"post",url:"http://localhost:8085/api/data/exportDataExcel",params:t,contentType:"application/x-www-form-urlencoded",responseType:"blob"}).then(function(t){console.log(t);var l=document.createElement("a"),o=new Blob([t.data],{type:"application/vnd.ms-excel"});l.style.display="none",l.href=URL.createObjectURL(o),"filingList"===e?l.setAttribute("download","公务员晋升职级人员备案名册.xls"):"reimbursement"===e&&l.setAttribute("download","公务员职级任免审批表.xls"),document.body.appendChild(l),l.click(),document.body.removeChild(l)}).catch(function(t){console.log(t)})},uploadSuccess:function(t,e){if(200!=t.code)return this.excelLoading=!1,this.$notify({title:"文件导入失败"+t.msg,type:"error",duration:25e3}),e;this.excelLoading=!1,this.$notify({title:"文件导入成功"+t.msg,type:"success",duration:25e3}),this.exceldialog=!1},handleError:function(t,e){var l=JSON.parse(t.message);this.$notify({title:l.message,type:"error",duration:2500})},beforeAvatarUpload:function(t){var e="xls"===t.name.split(".")[1],l="xlsx"===t.name.split(".")[1];return e||l||this.$message.error("上传w文件只能是 xls、xlsx格式!"),e||l},handleExceed:function(t){this.$message.warning("当前限制选择 1 个文件，请删除后继续上传")},submitAllUpload:function(){this.excelLoading=!0,this.category={fullImport:1,flag:this.flag},console.log(this.category),this.$refs.upload.submit(),this.allInfodialog=!1},submitUpload:function(){this.excelLoading=!0,this.category={fullImport:0,flag:this.flag},console.log(this.category),this.$refs.upload.submit(),this.allInfodialog=!1},uploadUrl:function(){return"http://localhost:8085/api/data/importPeople"},handleRemove:function(t){console.log(t)},handlePreview:function(t){console.log(t)},openAll:function(t){this.allInfodialog=!0,this.flag=t}}},a={render:function(){var t=this,e=t.$createElement,l=t._self._c||e;return l("div",{staticStyle:{"margin-top":"10px"}},[l("fieldset",{staticStyle:{width:"98%","border-color":"#b5b8c8","text-align":"center"}},[t._m(0),t._v(" "),l("el-row",[l("el-button",{attrs:{type:"primary",icon:"el-icon-download"},on:{click:function(e){return t.exportExcleMode("unit")}}},[t._v("单位信息采集表")]),t._v(" "),l("el-button",{attrs:{type:"success",icon:"el-icon-download"},on:{click:function(e){return t.exportExcleMode("people")}}},[t._v("人员信息采集表")])],1)],1),t._v(" "),l("el-dialog",{staticStyle:{width:"100%","margin-left":"0px"},attrs:{visible:t.centerDialogVisible,title:t.titles,"append-to-body":""},on:{"update:visible":function(e){t.centerDialogVisible=e}}},[l("el-form",{attrs:{model:t.form,size:"small","label-width":"140px"}},[l("el-form-item",{attrs:{label:"导出详情",prop:"dataFlag",hidden:"true"}},[l("el-input",{model:{value:t.form.dataFlag,callback:function(e){t.$set(t.form,"dataFlag",e)},expression:"form.dataFlag"}})],1),t._v(" "),t.radio?l("el-form-item",{attrs:{label:"单位",prop:"unit",rules:t.rules}},[l("el-select",{attrs:{filterable:"",placeholder:"请选择"},model:{value:t.form.unitName,callback:function(e){t.$set(t.form,"unitName",e)},expression:"form.unitName"}},t._l(t.unitSelect,function(t){return l("el-option",{key:t.value,ref:"slecte",refInFor:!0,attrs:{label:t.label,value:t.value}})}),1)],1):t._e(),t._v(" "),t.repeat?l("el-form-item",{attrs:{label:"单位",prop:"unit"},model:{value:t.form.unitIds,callback:function(e){t.$set(t.form,"unitIds",e)},expression:"form.unitIds"}},[l("el-tree",{ref:"tree",attrs:{data:t.units,"show-checkbox":"",placeholder:"输入名称搜索",filterable:"","node-key":"id","default-expand-all":"",props:t.defaultProps}})],1):t._e()],1),t._v(" "),l("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[l("el-button",{on:{click:function(e){t.centerDialogVisible=!1}}},[t._v("取 消")]),t._v(" "),l("el-button",{attrs:{type:"primary"},on:{click:t.exportData}},[t._v("确 定")])],1)],1),t._v(" "),l("el-dialog",{attrs:{visible:t.allInfodialog,"append-to-body":"",width:"500px"},on:{"update:visible":function(e){t.allInfodialog=e}}},[l("div",{attrs:{hidden:"true"}},[l("el-input",{attrs:{hidden:"true"},model:{value:t.flag,callback:function(e){t.flag=e},expression:"flag"}})],1),t._v(" "),l("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{drag:"",action:t.uploadUrl(),data:t.category,loading:t.excelLoading,limit:1,"on-exceed":t.handleExceed,name:"excelFile","on-preview":t.handlePreview,"on-remove":t.handleRemove,"on-error":t.handleError,"on-success":t.uploadSuccess,"auto-upload":!1,"before-upload":t.beforeAvatarUpload}},[l("i",{staticClass:"el-icon-upload"}),t._v(" "),l("div",{staticClass:"el-upload__text"},[t._v("将文件拖到此处，或"),l("em",[t._v("点击上传")])]),t._v(" "),l("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("一次只能上传一个文件，仅限Excel格式")])]),t._v(" "),l("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[l("el-button",{staticStyle:{float:"left"},attrs:{type:"primary"},on:{click:t.submitAllUpload}},[t._v("覆盖导入")]),t._v(" "),l("el-button",{attrs:{type:"primary"},on:{click:t.submitUpload}},[t._v("新增导入")])],1)],1)],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("legend",{staticStyle:{"text-align":"center"}},[e("span",[this._v("采集表下载区")])])}]};var n=l("VU/8")(i,a,!1,function(t){l("U8s4")},"data-v-3e8f0988",null);e.default=n.exports}});