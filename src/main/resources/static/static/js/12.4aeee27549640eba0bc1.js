webpackJsonp([12],{VoCs:function(t,e){},pF3t:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var l={data:function(){return{allInfodialog:!1,category:{},excelLoading:!1,flag:""}},methods:{exportExcleMode:function(t){var e={flag:t};this.$axios({method:"post",url:"http://152.136.134.221:8085/api/unit/outExcelModel",params:e,contentType:"application/x-www-form-urlencoded",responseType:"blob"}).then(function(e){console.log(e);var o=document.createElement("a"),l=new Blob([e.data],{type:"application/vnd.ms-excel"});o.style.display="none",o.href=URL.createObjectURL(l),"all"===t?o.setAttribute("download","全部信息采集表.xls"):"unit"===t?o.setAttribute("download","单位信息采集表.xls"):"people"===t&&o.setAttribute("download","人员信息采集表.xlsx"),document.body.appendChild(o),o.click(),document.body.removeChild(o)}).catch(function(t){console.log(t)})},uploadSuccess:function(t,e){if(200!=t.code)return this.excelLoading=!1,this.$notify({title:"文件导入失败"+t.msg,type:"error",duration:25e3}),e;this.excelLoading=!1,this.$notify({title:"文件导入成功"+t.msg,type:"success",duration:25e3}),this.exceldialog=!1},handleError:function(t,e){var o=JSON.parse(t.message);this.$notify({title:o.message,type:"error",duration:2500})},beforeAvatarUpload:function(t){var e="xls"===t.name.split(".")[1],o="xlsx"===t.name.split(".")[1];return e||o||this.$message.error("上传w文件只能是 xls、xlsx格式!"),e||o},handleExceed:function(t){this.$message.warning("当前限制选择 1 个文件，请删除后继续上传")},submitAllUpload:function(){this.excelLoading=!0,this.category={fullImport:1,flag:this.flag},console.log(this.category),this.$refs.upload.submit(),this.allInfodialog=!1},submitUpload:function(){this.excelLoading=!0,this.category={fullImport:0,flag:this.flag},console.log(this.category),this.$refs.upload.submit(),this.allInfodialog=!1},uploadUrl:function(){return"http://152.136.134.221:8085/api/unit/importAll"},handleRemove:function(t){console.log(t)},handlePreview:function(t){console.log(t)},openAll:function(t){this.allInfodialog=!0,this.flag=t}}},n={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("fieldset",{staticStyle:{width:"98%","border-color":"#b5b8c8"}},[t._m(0),t._v(" "),o("el-row",[o("el-button",{attrs:{icon:"el-icon-download"},on:{click:function(e){return t.exportExcleMode("all")}}},[t._v("全部信息采集表")]),t._v(" "),o("el-button",{attrs:{type:"primary",icon:"el-icon-download"},on:{click:function(e){return t.exportExcleMode("unit")}}},[t._v("单位信息采集表")]),t._v(" "),o("el-button",{attrs:{type:"success",icon:"el-icon-download"},on:{click:function(e){return t.exportExcleMode("people")}}},[t._v("人员信息采集表")]),t._v(" "),o("el-button",{attrs:{type:"info"}},[t._v("职务信息采集表")]),t._v(" "),o("el-button",{attrs:{type:"warning"}},[t._v("职级信息采集表")]),t._v(" "),o("el-button",{attrs:{type:"danger"}},[t._v("考核信息采集表")]),t._v(" "),o("el-button",{attrs:{type:"primary",plain:""}},[t._v("学历信息采集表")]),t._v(" "),o("el-button",{attrs:{type:"success",plain:""}},[t._v("奖惩信息采集表")])],1)],1),t._v(" "),o("fieldset",{staticStyle:{width:"98%","border-color":"#b5b8c8"}},[t._m(1),t._v(" "),o("el-row",[o("el-button",{on:{click:function(e){return t.openAll("all")}}},[t._v("全部信息表导入")]),t._v(" "),o("el-button",{attrs:{type:"primary",round:""}},[t._v("单位信息采集表")]),t._v(" "),o("el-button",{attrs:{type:"success",round:""}},[t._v("人员信息采集表")]),t._v(" "),o("el-button",{attrs:{type:"info",round:""}},[t._v("职务信息采集表")]),t._v(" "),o("el-button",{attrs:{type:"warning",round:""}},[t._v("职级信息采集表")]),t._v(" "),o("el-button",{attrs:{type:"danger",round:""}},[t._v("考核信息采集表")]),t._v(" "),o("el-button",{attrs:{type:"primary",plain:""}},[t._v("学历信息采集表")]),t._v(" "),o("el-button",{attrs:{type:"success",plain:""}},[t._v("奖惩信息采集表")])],1)],1),t._v(" "),o("el-dialog",{attrs:{visible:t.allInfodialog,"append-to-body":"",width:"500px"},on:{"update:visible":function(e){t.allInfodialog=e}}},[o("div",{attrs:{hidden:"true"}},[o("el-input",{attrs:{hidden:"true"},model:{value:t.flag,callback:function(e){t.flag=e},expression:"flag"}})],1),t._v(" "),o("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{drag:"",action:t.uploadUrl(),data:t.category,loading:t.excelLoading,limit:1,"on-exceed":t.handleExceed,name:"excelFile","on-preview":t.handlePreview,"on-remove":t.handleRemove,"on-error":t.handleError,"on-success":t.uploadSuccess,"auto-upload":!1,"before-upload":t.beforeAvatarUpload}},[o("i",{staticClass:"el-icon-upload"}),t._v(" "),o("div",{staticClass:"el-upload__text"},[t._v("将文件拖到此处，或"),o("em",[t._v("点击上传")])]),t._v(" "),o("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("一次只能上传一个文件，仅限Excel格式")])]),t._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{staticStyle:{float:"left"},attrs:{type:"primary"},on:{click:t.submitAllUpload}},[t._v("覆盖导入")]),t._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:t.submitUpload}},[t._v("新增导入")])],1)],1)],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("legend",{staticStyle:{"text-align":"center"}},[e("span",[this._v("采集表下载区")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("legend",{staticStyle:{"text-align":"center"}},[e("span",[this._v("数据导入区")])])}]};var a=o("VU/8")(l,n,!1,function(t){o("VoCs")},"data-v-a53e9eda",null);e.default=a.exports}});