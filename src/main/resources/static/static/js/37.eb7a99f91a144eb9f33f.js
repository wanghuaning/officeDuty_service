webpackJsonp([37],{"ffp/":function(e,t){},zTJK:function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=l("gN++"),a=l("R2SV"),i={name:"exportPeople",mixins:[l("Ks07").a],data:function(){return{loading:!1,dialog:!1,unitSelect:[],unitId:"",downloadLoading:!1,selectPeople:[],title:"人员导出",data:[],query:{unitName:"",states:"全部"},enabledTypeOptions:[{key:"全部",display_name:"全部"},{key:"在职",display_name:"在职"},{key:"调出",display_name:"调出"},{key:"退休",display_name:"退休"},{key:"其他",display_name:"其他"}]}},methods:{beforeInit:function(){this.url="api/people/info";var e=this.query,t=e.states,l=e.name,o=e.unitName;return this.params={page:this.page,size:this.size,sort:"id,desc",unitId:this.unitId,name:l,states:t,unitName:o},!0},downloadPeople:function(){var e=this,t=this.query.states;if("调出"===t){var l=[];if(void 0!==this.multipleTable&&""!=this.multipleTable){for(var o=0;o<this.multipleTable.length;o++){var a=this.multipleTable[o].id;l.push(a)}var i={unitId:this.unitId,peopleIds:l};this.outOutPeopleExcel(i)}else this.$notify({title:"请选择导出人员",type:"error",duration:25e3})}else this.$confirm("是否包含下级单位?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(function(){var l={unitId:e.unitId,isChild:"1",states:t};e.outExcel(l)}).catch(function(){var l={unitId:e.unitId,isChild:"0",states:t};e.outExcel(l)})},outExcel:function(e){this.downloadLoading=!0;var t=this;this.$axios({method:"post",url:"http://localhost:8085/api/people/outExcel",params:e,contentType:"application/x-www-form-urlencoded",responseType:"blob"}).then(function(e){console.log(e);var l=document.createElement("a"),o=new Blob([e.data],{type:"application/vnd.ms-excel"});l.style.display="none",l.href=URL.createObjectURL(o),l.setAttribute("download","人员信息表导出.xls"),document.body.appendChild(l),l.click(),document.body.removeChild(l),t.downloadLoading=!1}).catch(function(e){console.log(e)})},getUnitTrees:function(){var e=this;Object(o.l)().then(function(t){e.unitSelect=t.result,e.unitName=t.result[0].name})},outOutPeopleExcel:function(e){this.downloadLoading=!0;var t=this,l=this.unitName+"_调出人员信息表导出.zip";this.$axios({method:"post",url:"http://localhost:8085/api/people/outOutPeopleExcel",params:e,contentType:"application/x-www-form-urlencoded",responseType:"blob"}).then(function(e){console.log(e);var o=document.createElement("a"),a=new Blob([e.data],{type:"application/vnd.ms-zip"});o.style.display="none",o.href=URL.createObjectURL(a),o.setAttribute("download",l),document.body.appendChild(o),o.click(),document.body.removeChild(o),t.downloadLoading=!1}).catch(function(e){console.log(e)})},formatter:function(e,t,l,o){if(null!=e[t.property])return Object(a.a)(e[t.property])},handleSelectionChange:function(e){if(this.selectPeople=[],this.multipleTable=e,void 0!==this.multipleTable&&""!=this.multipleTable)for(var t=0;t<this.multipleTable.length;t++){var l=this.multipleTable[t].name;this.selectPeople.push(l)}}},created:function(){var e=this;this.$nextTick(function(){e.init()}),this.getUnitTrees()}},n={render:function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("el-dialog",{staticStyle:{"margin-left":"0px"},attrs:{visible:e.dialog,title:"人员导出","append-to-body":"",width:"90%"},on:{"update:visible":function(t){e.dialog=t}}},[l("div",{staticClass:"head-container",staticStyle:{"padding-top":"10px"}},[l("el-select",{staticStyle:{width:"30%"},attrs:{filterable:"",placeholder:"请选择"},on:{change:e.toQuery},model:{value:e.query.unitName,callback:function(t){e.$set(e.query,"unitName",t)},expression:"query.unitName"}},e._l(e.unitSelect,function(e){return l("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1),e._v(" "),l("el-input",{staticClass:"filter-item",staticStyle:{width:"10%"},attrs:{clearable:"",placeholder:"姓名或简名"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.toQuery(t)}},model:{value:e.query.name,callback:function(t){e.$set(e.query,"name",t)},expression:"query.name"}}),e._v(" "),l("el-select",{staticClass:"filter-item",staticStyle:{width:"10%"},attrs:{clearable:"",placeholder:"请选择人员状态"},on:{change:e.toQuery},model:{value:e.query.states,callback:function(t){e.$set(e.query,"states",t)},expression:"query.states"}},e._l(e.enabledTypeOptions,function(e){return l("el-option",{key:e.key,attrs:{label:e.display_name,value:e.key}})}),1),e._v(" "),l("el-button",{staticClass:"filter-item",attrs:{size:"mini",type:"success",icon:"el-icon-search"},on:{click:e.toQuery}},[e._v("搜索\n  ")])],1),e._v(" "),l("div",[l("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%","font-size":"10px"},attrs:{"header-cell-style":{"text-align":"center",background:"#ADD8E6",color:"#030303"},"cell-style":{padding:"0px"},data:e.data,size:"small","row-key":"id","element-loading-text":"请稍后","highlight-current-row":"","element-loading-spinner":"el-icon-loading",border:""},on:{"selection-change":e.handleSelectionChange}},[l("el-table-column",{attrs:{type:"selection","reserve-selection":!0,width:"55"}}),e._v(" "),l("el-table-column",{attrs:{type:"index",label:"序号",fixed:"left",width:"60"}}),e._v(" "),l("el-table-column",{attrs:{sortable:"","show-overflow-tooltip":!0,fixed:"left",label:"姓名",prop:"name"}}),e._v(" "),l("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"idcard",width:"180px",label:"身份证号"}}),e._v(" "),l("el-table-column",{attrs:{sortable:"","show-overflow-tooltip":!0,formatter:e.formatter,width:"110px",prop:"birthday",label:"出生年月"}}),e._v(" "),l("el-table-column",{attrs:{"show-overflow-tooltip":!0,width:"50px",prop:"sex",label:"性别"}}),e._v(" "),l("el-table-column",{attrs:{"show-overflow-tooltip":!0,width:"120px",prop:"birthplace",label:"籍贯"}}),e._v(" "),l("el-table-column",{attrs:{sortable:"","show-overflow-tooltip":!0,width:"80px",prop:"nationality",label:"民族"}}),e._v(" "),l("el-table-column",{attrs:{"show-overflow-tooltip":!0,formatter:e.formatter,width:"110px",prop:"workday",label:"参加工作时间"}}),e._v(" "),l("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"states",width:"90px",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("el-tag",{attrs:{type:"在职"===t.row.states?"success":"warning"}},[e._v(e._s(t.row.states))])]}}])}),e._v(" "),l("el-table-column",{attrs:{sortable:"","show-overflow-tooltip":!0,prop:"party",width:"110px",label:"政治面貌"}}),e._v(" "),l("el-table-column",{attrs:{sortable:"","show-overflow-tooltip":!0,prop:"position",width:"100px",label:"职务层次"}}),e._v(" "),l("el-table-column",{attrs:{sortable:"","show-overflow-tooltip":!0,prop:"positionLevel",width:"100px",label:"现任职级"}}),e._v(" "),l("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"politicalStatus",label:"编制类型"}})],1),e._v(" "),l("el-pagination",{staticStyle:{"margin-top":"2px",float:"right"},attrs:{total:e.total,"current-page":e.page+1,layout:"total, prev, pager, next, jumper, sizes"},on:{"size-change":e.sizeChange,"current-change":e.pageChange}}),e._v(" "),l("div",{staticStyle:{color:"#333333","text-align":"center"}},[e._v("\n      "+e._s(this.selectPeople)+"\n    ")])],1),e._v(" "),l("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[l("el-button",{attrs:{type:"text"},on:{click:function(t){e.dialog=!1}}},[e._v("取消")]),e._v(" "),l("el-button",{attrs:{loading:e.downloadLoading,type:"primary"},on:{click:e.downloadPeople}},[e._v("导出")])],1)])},staticRenderFns:[]};var s=l("VU/8")(i,n,!1,function(e){l("ffp/")},"data-v-75f1689e",null);t.default=s.exports}});